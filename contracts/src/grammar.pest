// src/grammar.pest

WHITESPACE = _{ " " | "\t" | "\n" | COMMENT }

COMMENT = _{ "//" ~ (!"\n" ~ ANY)* ~ ("\n" | EOI) }

dot = { "." }

program = { SOI ~ contract* ~ EOI }

contract = { "contract" ~ ident ~ "{" ~ function* ~ "}" }

function = { "function" ~ ident ~ "(" ~ parameter_list? ~ ")" ~ block }

parameter_list = { ident ~ ("," ~ ident)* }

block = { "{" ~ statement* ~ "}" }

statement = { assignment | function_call }

assignment = { ident ~ "=" ~ expression ~ ";" }

function_call = { ident ~ (dot ~ ident)? ~ "(" ~ argument_list? ~ ")" ~ ";" }

argument_list = { expression ~ ("," ~ expression)* }

expression = { addition }  // Removed the underscore to make it a visible rule

addition = { multiplication ~ (add_op ~ multiplication)* }

add_op = { "+" | "-" }  // Added this rule

multiplication = { unary ~ (mul_op ~ unary)* }

mul_op = { "*" | "/" }  // Added this rule

unary = { (operator_unary)* ~ primary }

operator_unary = { "+" | "-" }  // Added this rule

primary = { number | ident | string | "(" ~ expression ~ ")" }

ident = @{ (ASCII_ALPHANUMERIC | "_")+ }

number = @{ ASCII_DIGIT+ }

string = @{ "\"" ~ (!"\"" ~ ANY)* ~ "\"" }
